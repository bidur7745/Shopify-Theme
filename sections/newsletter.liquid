{% comment %}
  Newsletter Section: A standalone newsletter signup section for the homepage
{% endcomment %}

<link rel="stylesheet" href="{{ 'newsletter.css' | asset_url }}">

<section class="newsletter-section">
  <div class="newsletter-container">
    <div class="newsletter-content">
      <h2 class="newsletter-title">{{ section.settings.title | escape }}</h2>
      <div class="newsletter-description">
        {{ section.settings.description }}
      </div>
      
      <div class="newsletter-form-wrapper">
        {% form 'customer', class: 'newsletter-form' %}
          <input type="hidden" name="contact[tags]" value="newsletter">
          <div class="newsletter-field-wrapper">
            <div class="newsletter-field">
              <input
                id="NewsletterForm--{{ section.id }}"
                type="email"
                name="contact[email]"
                class="newsletter-input"
                value="{{ form.email }}"
                aria-required="true"
                autocorrect="off"
                autocapitalize="off"
                autocomplete="email"
                {% if form.errors %}
                  autofocus
                  aria-invalid="true"
                  aria-describedby="Newsletter-error--{{ section.id }}"
                {% elsif form.posted_successfully? %}
                  aria-describedby="Newsletter-success--{{ section.id }}"
                {% endif %}
                placeholder="{{ 'newsletter.label' | t }}"
                required
              >
              <label class="newsletter-label" for="NewsletterForm--{{ section.id }}">
                {{ 'newsletter.label' | t }}
              </label>
            </div>
            <button type="submit" class="newsletter-button" name="commit">
              {{ section.settings.button_label | escape }}
            </button>
          </div>
          {%- if form.errors -%}
            <div class="newsletter-form-message form-message--error" id="Newsletter-error--{{ section.id }}" role="alert">
              <h3 class="newsletter-form-message-title">{{ form.errors.translated_fields.email | capitalize }} {{ form.errors.messages.email }}</h3>
            </div>
          {%- endif -%}
          {%- if form.posted_successfully? -%}
            <div class="newsletter-form-message form-message--success" id="Newsletter-success--{{ section.id }}" role="status">
              <h3 class="newsletter-form-message-title">{{ 'newsletter.success' | t }}</h3>
            </div>
          {%- endif -%}
        {% endform %}
      </div>
    </div>
    
    {% if section.settings.show_background and section.settings.background_image != blank %}
      <div class="newsletter-background">
        <img src="{{ section.settings.background_image | image_url: width: 1500 }}" alt="" class="newsletter-background-image">
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Newsletter",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "default": "Subscribe to our newsletter",
      "label": "Title"
    },
    {
      "type": "richtext",
      "id": "description",
      "default": "<p>Be the first to know about new collections, exclusive offers and fashion tips.</p>",
      "label": "Description"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "Subscribe",
      "label": "Button label"
    },
    {
      "type": "checkbox",
      "id": "show_background",
      "default": true,
      "label": "Show background image"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    }
  ],
  "presets": [
    {
      "name": "Newsletter",
      "category": "Promotional"
    }
  ]
}
{% endschema %}